name: HUMEAN Basic Test
on: workflow_dispatch
jobs:
  basic-check:
    runs-on: [self-hosted, windows]
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Test Deepseek
        shell: powershell
        env:
          DEEPSEEK_API_KEY: ${{ secrets.DEEPSEEK_API_KEY }}
        run: |
          $headers = @{ 
            "Content-Type" = "application/json"
            "Authorization" = "Bearer $env:DEEPSEEK_API_KEY"
          }
          $body = @{
            model = "deepseek-chat"
            messages = @(@{role="user"; content="Repond HUMEAN_OK"})
          } | ConvertTo-Json
          
          try {
            $response = Invoke-RestMethod -Uri "https://api.deepseek.com/chat/completions" -Method Post -Headers $headers -Body $body
            Write-Host "SUCCES: $($response.choices[0].message.content)"
            exit 0
          } catch {
            Write-Host "ERREUR: $($_.Exception.Message)"
            exit 1
          }

      - name: Success
        if: success()
        run: echo "HUMEAN SYSTEM OPERATIONNEL"
